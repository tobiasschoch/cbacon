/* test cases for weighted quantile and selection of k-th largest element 

   Copyright (C) 2020 Tobias Schoch (e-mai: tobias.schoch@gmail.com) 

   This library is free software; you can redistribute it and/or
   modify it under the terms of the GNU Library General Public
   License as published by the Free Software Foundation; either
   version 2 of the License, or (at your option) any later version.

   This library is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
   Library General Public License for more details.

   You should have received a copy of the GNU Library General Public
   License along with this library; if not, a copy is available at
   https://www.gnu.org/licenses/
*/


#include <R.h>
#include <Rmath.h>
#include <R_ext/Lapack.h>
#include <R_ext/BLAS.h>
#include <stdio.h>
#include "cbacon.h"
#include "wquantile.h"


/******************************************************************************\
|* main									      *| 
\******************************************************************************/
int main(){

#if 1
   int verbose = 1, n = 62, p = 8, maxiter = 50;
   double x[] = {-0.030,  0.015,  0.025,  0.030, -0.070, -0.050, -0.247, -0.099, -0.242, -0.188, -0.099, -0.232, -0.045,  0.055,  0.070, -0.015, -0.109,  0.000, -0.193, -0.090, -0.154, -0.154, -0.149, -0.271,  0.243,  0.340,  0.080,  0.131,  0.136,  0.176,  0.151,  0.207, -0.015,  0.126,  0.131,  0.070,  0.156,  0.055, -0.015,  0.090,  0.015,  0.010,  0.131,  0.000, -0.099, -0.188, -0.173, -0.227,  0.314,  0.217,  0.381,  0.397,  0.289,  0.202,  0.273,  0.558, -0.672, -0.605, -0.694, -0.559, -0.415, -0.324, 35.239, 35.713, 39.220, 39.756, 32.991, 31.140, 28.375, 32.580, 23.889, 28.027, 33.128, 26.492, 32.169, 35.103, 40.893, 32.649, 27.749, 36.187, 34.491, 31.827, 29.622, 35.917, 30.658, 29.415, 51.638, 58.686, 49.025, 46.266, 50.333, 44.218, 43.887, 48.894, 40.158, 54.559, 49.025, 49.287, 45.673, 45.475, 42.958, 48.632, 49.025, 43.821, 46.530, 46.398, 44.946, 51.898, 48.436, 47.254, 56.627, 53.458, 60.993, 58.429, 56.755, 56.111, 53.847, 63.035,  3.448,  2.845,  1.515,  2.054,  3.018, 17.639, 36.991, 36.851, 30.586, 21.072, 36.570, 38.115, 41.364, 36.430, 49.080, 39.243, 32.802, 40.939, 32.524, 31.139, 21.473, 31.554, 38.538, 25.927, 25.519, 29.209, 32.385, 29.346, 35.730, 33.775, 15.922,  9.159, 27.700, 23.893, 17.888, 26.880, 33.775, 23.219, 42.074, 11.293, 17.494, 23.354, 29.622, 21.072, 33.636, 13.977, 18.284, 27.290, 18.284, 18.416, 24.164, 19.209, 26.880, 29.346,  2.925,  0.511,  0.000,  1.147,  0.407,  0.407,  2.023, -0.391, 76.878, 84.554, 81.988,  8.786,  5.855, 28.934,  1.057,  1.064,  1.053,  1.050,  1.049,  1.052,  1.044,  1.038,  1.042,  1.042,  1.052,  1.042,  1.045,  1.042,  1.049,  1.038,  1.036,  1.022,  1.047,  1.050,  1.057,  1.033,  1.033,  1.033,  1.099,  1.101,  1.097,  1.076,  1.095,  1.090,  1.082,  1.081,  1.066,  1.089,  1.088,  1.092,  1.070,  1.076,  1.085,  1.070,  1.073,  1.087,  1.069,  1.075,  1.078,  1.064,  1.065,  1.066,  1.118,  1.122,  1.118,  1.129,  1.113,  1.104,  1.111,  1.113,  1.020,  1.008,  0.998,  1.081,  1.033,  1.070, 21.312, 21.206, 20.709, 19.542, 20.449, 20.841, 19.060, 18.597, 19.346, 18.720, 18.587, 19.813, 19.989, 19.116, 18.769, 18.708, 19.323, 17.433, 19.195, 19.436, 20.136, 16.740, 18.589, 19.422, 24.420, 25.288, 26.119, 23.113, 25.209, 25.444, 23.699, 24.303, 24.793, 23.438, 24.197, 24.741, 24.170, 24.174, 25.052, 23.846, 24.822, 25.200, 23.695, 24.941, 25.007, 21.183, 21.875, 22.095, 25.166, 24.560, 22.007, 21.115, 26.194, 25.674, 25.930, 21.390, 18.441, 16.441, 16.294, 20.289, 17.163, 20.289,  7.039,  6.979,  6.779,  6.601,  6.795,  6.919,  6.447,  6.261,  6.572,  6.455,  6.295,  6.775,  6.737,  6.512,  6.335,  6.271,  6.550,  5.948,  6.213,  6.387,  6.725,  6.168,  6.531,  6.615,  7.874,  8.034,  8.222,  7.288,  7.955,  8.045,  7.593,  7.775,  8.123,  7.650,  7.794,  7.996,  7.766,  7.877,  8.287,  7.639,  8.041,  8.270,  7.460,  7.929,  8.081,  7.156,  7.336,  7.447,  7.913,  7.854,  8.259,  7.913,  8.454,  8.208,  8.100,  7.475,  6.652,  6.315,  6.572,  7.719,  7.086,  7.437,  5.326,  5.237,  5.060,  4.479,  4.912,  5.108,  4.246,  4.032,  4.358,  4.072,  4.068,  4.604,  4.686,  4.299,  4.089,  3.978,  4.404,  3.486,  4.300,  4.404,  4.723,  3.201,  3.989,  4.382,  6.999,  7.406,  7.771,  6.329,  7.296,  7.477,  6.609,  6.861,  7.202,  6.457,  6.833,  7.152,  6.846,  6.826,  7.332,  6.615,  7.129,  7.356,  6.567,  7.286,  7.287,  5.388,  5.762,  5.790,  7.211,  7.020,  7.322,  6.557,  7.816,  7.534,  7.669,  5.294,  3.946,  2.997,  3.017,  4.866,  3.396,  4.859,  0.932,  0.871,  0.742,  0.513,  0.577,  0.784,  0.358,  0.215,  0.432,  0.372,  0.239,  0.637,  0.779,  0.588,  0.470,  0.457,  0.588,  0.104,  0.405,  0.519,  0.652,  0.104,  0.336,  0.432,  1.730,  1.873,  1.946,  1.513,  1.792,  1.847,  1.482,  1.583,  1.703,  1.477,  1.583,  1.728,  1.615,  1.692,  1.773,  1.560,  1.721,  1.785,  1.543,  1.703,  1.787,  0.924,  1.068,  1.182,  1.813,  1.701,  1.169,  0.928,  2.145,  2.046,  2.037,  0.875,  0.140, -0.400, -0.478,  0.239, -0.236,  0.470};
#endif

#if 0
   int verbose = 1, n = 23, p = 4, maxiter = 50;
   double x[] = {6.3, 6.0, 5.9, 3.0, 5.0, 6.3, 5.6, 3.6, 2.0, 2.9, 2.2, 3.9, 4.5, 4.3, 4.0, 3.2, 4.3, 2.4, 2.8, 3.9, 2.8, 1.6, 3.4, 1.7, 1.9, 1.5, 1.2, 1.8, 2.0, 1.6, 1.2, 1.4, 2.3, 1.9, 2.6, 2.0, 9.7, 2.9, 4.3, 4.3, 2.6, 3.7, 3.3, 3.9, 4.1, 2.5, 8176.0, 6699.0, 9663.0, 12837.0, 10205.0, 14890.0, 13836.0, 11628.0, 15225.0, 18691.0, 19350.0, 20638.0, 12843.0, 13384.0, 13307.0, 29855.0, 29277.0, 24651.0, 28539.0, 8085.0, 30328.0, 46172.0, 17836.0, 4500.0, 3120.0, 6300.0, 9800.0, 4900.0, 6500.0, 8920.0, 14500.0, 14800.0, 10900.0, 16000.0, 16000.0, 7800.0, 17900.0, 10500.0, 24500.0, 30000.0, 24500.0, 34000.0, 8160.0, 35800.0, 37000.0, 19600.0};
#endif 

   double w[n]; 
   for (int i = 0; i < n; i++) 
      w[i] = 1.0;


#if 1
   int subset[n];
   double alpha, cutoff;
   double dist[n];
   double center[p]; 
   double scatter[p * p];
   double setofalphas[9] = {0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9};

   for (int i = 0; i < 9; i++) {
      alpha = setofalphas[i];
      printf("---------------------------------------\nalpha = %.2f\n", alpha);
      wbacon(x, w, center, scatter, dist, &n, &p, &alpha, subset, &cutoff, 
	 &maxiter, &verbose);

      printf("center\n");
      for (int i = 0; i < p; i++) 
	 printf("%.3f\t", center[i]);  	
      printf("\n");
   }

#endif

   return 0;
}


